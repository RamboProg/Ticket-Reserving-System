<!DOCTYPE html>
<html>
<head>
    <link rel='stylesheet' href='/styles/bootstrap.min.css' />
    <link rel='stylesheet' href='/styles/style.css' />
    <script src="/js/jquery-2.2.0.min.js" type="text/javascript"></script>
    <script src="/js/bootstrap.min.js" type="text/javascript"></script>
    <style>
       .position-relative {
        position: relative;
        margin-bottom: 50px;
    }

    .create-button {
        position: absolute;
        bottom: 10px;
        right: 10px;
    }
    </style>
</head>
<body>
<script>
    $(document).ready(function () {

        $.ajax({
            type: "GET",
            url: '/api/v1/station',
            success: function (data) {
                console.log(data)
                for (let row of data) {
                    $('#tbody').append(
                        `<tr>
                             <td class="text-center">${row.id}</td>
                             <td class="text-center">${row.stationname}</td>
                             <td class="text-center">${row.stationtype}</td>
                             <td class="text-center">${row.stationposition}</td>
                             <td class="text-center">${row.stationstatus}</td>
                             <td class="text-center">
                                <button id=${row.id} class="btn btn-primary update" type="button">Update Name</button>
                             </td>
                             <td class="text-center">
                                 <button id=${row.id} class="btn btn-danger remove" type="button">Remove</button>
                             </td>
                         </tr>`);
                }
            },
            error: function (error) {
                alert(error)
                console.log("error message", error.responseText);
            }
        });

        $('#tbody').on('click', '.remove', function () {
            console.log("Removed Station")
            var id = $(this).attr('id');
            $.ajax({
                type: "DELETE",
                url: '/api/v1/station/' + `${id}`,
                success: function (data) {
                    alert(data)
                },
                error: function (error) {
                    alert(error.responseText)
                }
            });
        });

        $('#tbody').on('click', '.update', function () {

            var id = $(this).attr('id');
            console.log(id);

            var myNewName = prompt("Enter new Station Name");


            $.ajax({
                type: "PUT",
                url: `/api/v1/station/ ${id}`,
                data: {stationname: myNewName},
                success: function (data) {
                    alert(data)
                },
                error: function (error) {
                    alert(error.responseText)
                }
            });
        });


        $('#Create').on('click', function () {


            var stationname = prompt("Enter new Station Name");
            $.ajax({
                type: "POST",
                url: '/api/v1/station',
                data: {stationname},
                success: function (data) {
                    alert(data)
                },
                error: function (error) {
                    alert(error.responseText)
                }
            });
        });

    });

</script>
<div>
    <nav class="navbar navbar-inverse" style="padding-left:130px;">
        <ul class="nav navbar-nav">
            <li class="active"><a href="/dashboard">Home</a></li>
            <li><a href="/manage_stations">Station</a></li>
            <li><a href="/users">Users</a></li>
            <li><a href="/users/add">Add Users</a></li>
            <li><a href="/resetPassword">Reset Password</a></li>
            <li><a href="/">Logout</a></li>
        </ul>
    </nav>
</div>

<div class="container position-relative">
    <table class="table table-striped">
        <thead>
        <tr>
            <th class="text-center">ID</th>
            <th class="text-center">Station Name</th>
            <th class="text-center">Station Type</th>
            <th class="text-center">Station Position</th>
            <th class="text-center">Station Status</th>
        </tr>
        </thead>
        <tbody id="tbody">

        </tbody>
    </table>

    <button id="Create" class="btn btn-secondary create-button" type="button">Create New Station</button>
</div>

</body>
</html>
